Here's an example exploit snippet written in C:

```C
int main(int argc, char **argv) {
    int skfd; // generic raw socket desc.
    if (argc == 2)
        printinfo(skfd, argv[1], NULL, 0);
    . . .
}

static int printinfo(int skfd, char *ifname, char *args[], int count) {
    struct wirelessinfo info;
    int rc;
    rc = getinfo(skfd, ifname, &info);
    . . .
}

static int getinfo(int skfd, char *ifname, struct wirelessinfo *info) {
    struct iwreqwrq;
    if (iwgetext(skfd, ifname, SIOCGIWNAME, &wrq) < 0) {
        struct ifreq ifr;
        strcpy(ifr.ifr_name, ifname); // bufferoverflow
    }
    . . .
}
```
